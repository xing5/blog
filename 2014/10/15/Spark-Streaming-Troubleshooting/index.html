<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Spark Streaming Troubleshooting | Xing&#39;s</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="This article is a record for the problems I met when developing Spark Streaming applications.">
<meta property="og:type" content="article">
<meta property="og:title" content="Spark Streaming Troubleshooting">
<meta property="og:url" content="http://xingwu.me/2014/10/15/Spark-Streaming-Troubleshooting/index.html">
<meta property="og:site_name" content="Xing's">
<meta property="og:description" content="This article is a record for the problems I met when developing Spark Streaming applications.">
<meta property="og:image" content="http://xingwu.me/images/spark-classpath.png">
<meta property="og:updated_time" content="2016-11-27T18:38:35.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Spark Streaming Troubleshooting">
<meta name="twitter:description" content="This article is a record for the problems I met when developing Spark Streaming applications.">
<meta name="twitter:image" content="http://xingwu.me/images/spark-classpath.png">
<meta name="twitter:creator" content="@coolwuxing">
  
    <link rel="alternative" href="/atom.xml" title="Xing&#39;s" type="application/atom+xml">
  
  
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
  
  <link href="//fonts.googleapis.com/css?family=Inconsolata:400,700|Open+Sans:700,400" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-43935113-3', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>
<body>
  <div id="container">
    <div id="wrap">
      <div id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <div id="header-title">
        <h1 id="logo-wrap">
          <a href="/" id="logo">Xing&#39;s
          
              <span id="subtitle">Coding the Future</span>
          
          </a>
        </h1>
      </div>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://xingwu.me"></form>
      </div>
    </div>
  </div>
</div>
      <div id="main-wrap" class="outer">
        <section id="main"><article id="post-Spark-Streaming-Troubleshooting" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/10/15/Spark-Streaming-Troubleshooting/" class="article-date">
  <time datetime="2014-10-15T22:33:18.000Z" itemprop="datePublished">Oct 15 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Tech/">Tech</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Spark Streaming Troubleshooting
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>This article is a record for the problems I met when developing Spark Streaming applications. </p>
<a id="more"></a>
<h2 id="Where-are-the-logs"><a href="#Where-are-the-logs" class="headerlink" title="Where are the logs?"></a>Where are the logs?</h2><h3 id="Which-log4j-properties-the-Spark-is-using"><a href="#Which-log4j-properties-the-Spark-is-using" class="headerlink" title="Which log4j.properties the Spark is using?"></a>Which log4j.properties the Spark is using?</h3><p><strong><em>Log4j</em></strong> reads the first <em>log4j.properties</em> it finds in the class path. 
So if you want to use <code>$SPARK_PATH/conf/log4j.properties</code>, make sure it’s the first one to be found in your class path.
<img src="/images/spark-classpath.png" alt=""></p>
<h3 id="Some-logs-just-don’t-show-up"><a href="#Some-logs-just-don’t-show-up" class="headerlink" title="Some logs just don’t show up?"></a>Some logs just don’t show up?</h3><p>This probably because of that you search the wrong place. The application you submit to Spark is just a <code>driver program</code> that creates the <code>SparkContext</code>. 
DStreams is processed by Spark workers, all the logs inside DStreams transformation functions are going through workers’ standard output and written to <code>$SPARK_PATH/tmp/APPDIR/workerNo/stdout</code>.
You can also view them through the Spark web UI, which is at <code>$MASTER_IP:8080</code> by default. Click the app and then you will see links to the logs on workers.</p>
<h2 id="Cannot-Launch-App"><a href="#Cannot-Launch-App" class="headerlink" title="Cannot Launch App?"></a>Cannot Launch App?</h2><p>When lauching several apps you may meet a problem like this:</p>
<blockquote>
<p>org.apache.spark.scheduler.TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient memory</p>
</blockquote>
<p>This is because of either not enough cores or memory. To solve this problem, first make sure which one you are short of by checking the cluster status on the Spark web UI. Then adjust them as following.</p>
<h3 id="More-Workers"><a href="#More-Workers" class="headerlink" title="More Workers?"></a>More Workers?</h3><p>1. Add more slaves to <code>$SPARK_PATH/conf/slaves</code>
2. Adjust worker instances per slave:
<figure class="highlight bash"><figcaption><span>$SPARK_PATH/conf/spark-env.sh</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">export</span> SPARK_WORKER_INSTANCES=2</div></pre></td></tr></table></figure></p>
<h3 id="Memory-Size-per-Worker"><a href="#Memory-Size-per-Worker" class="headerlink" title="Memory Size per Worker"></a>Memory Size per Worker</h3><figure class="highlight bash"><figcaption><span>$SPARK_PATH/conf/spark-env.sh</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">export</span> SPARK_DAEMON_MEMORY=1g</div><div class="line"><span class="built_in">export</span> SPARK_WORKER_MEMORY=1g</div></pre></td></tr></table></figure>
<h3 id="Memory-Size-per-App"><a href="#Memory-Size-per-App" class="headerlink" title="Memory Size per App"></a>Memory Size per App</h3><p>You can set the memory usage of your app when you submit it:
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./bin/spark-submit --class org.apache.spark.examples.SparkPi --master spark://CentOS65-001:7077 --executor-memory 128M lib/spark-examples-1.0.2-hadoop1.0.3-mapr-3.0.3.jar</div></pre></td></tr></table></figure></p>
<h3 id="Core-Numbers-per-Worker"><a href="#Core-Numbers-per-Worker" class="headerlink" title="Core Numbers per Worker"></a>Core Numbers per Worker</h3><figure class="highlight bash"><figcaption><span>$SPARK_PATH/conf/spark-env.sh</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">export</span> SPARK_WORKER_CORES=2</div></pre></td></tr></table></figure>
<h3 id="Core-Numbers-per-App"><a href="#Core-Numbers-per-App" class="headerlink" title="Core Numbers per App"></a>Core Numbers per App</h3><p>Specify the core numbers in your app. Or in <code>$SPARK_PATH/conf/spark-defaults.conf</code>:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">spark.cores.max 2</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://xingwu.me/2014/10/15/Spark-Streaming-Troubleshooting/" data-id="cixny1n4f000n07pgllmv8470" class="article-share-link">Share</a>
      
        <a href="http://xingwu.me/2014/10/15/Spark-Streaming-Troubleshooting/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Big-Data/">Big Data</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Spark/">Spark</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Spark-Streaming/">Spark Streaming</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Troubleshooting/">Troubleshooting</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2014/10/19/Real-time-Web-Dashboard-Using-Socket-io-and-Highcharts/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Real-time Web Dashboard Using Socket.io and Highcharts
        
      </div>
    </a>
  
  
    <a href="/2014/10/13/Using-Google-Maps-API-to-Implement-a-Two-dimension-Heatmap-like-Tableau/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Using Google Maps API to Implement a Two-dimensional Circle Heatmap like Tableau</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
          
            <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Game/">Game</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tech/">Tech</a><span class="category-list-count">13</span></li></ul>
    </div>
  </div>

  
    
    <div class="widget-wrap">
      <h3 class="widget-title">Related</h3>
      <div class="widget recents">
        <ul>
  
    <li>
      <a href="/2014/10/11/Implement-Spark-Streaming-Applications-in-Java/">Implement Spark Streaming Applications in Java</a>
    </li>
  
    <li>
      <a href="/2014/10/04/Implement-a-Flume-Deserializer-Plugin-to-Import-XML-Files/">Implement a Flume Deserializer Plugin to Import XML Files</a>
    </li>
  
    <li>
      <a href="/2014/10/07/Load-Data-to-Hive-Using-Flume/">Load Data to Hive Using Flume</a>
    </li>
  
    <li>
      <a href="/2014/10/11/Routing-Flume-Events-to-Different-Sinks/">Routing Flume Events to Multiple Sinks</a>
    </li>
  
        </ul>
      </div>
    </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget recents">
      <ul>
        
          <li>
            <a href="/2014/12/11/Build-A-Resume-From-Your-LinkedIn-Profile/">Build A Resume From Your LinkedIn Profile</a>
          </li>
        
          <li>
            <a href="/2014/12/10/My-AWS-Account-Got-Compromised/">My AWS Account Got Compromised</a>
          </li>
        
          <li>
            <a href="/2014/11/26/Share-My-Diablo-3-Bot-Ghom-Farming-Auto-Pick-Up-Legendary-Notification/">Share My Diablo 3 Bot: Ghom Farming/Auto Pick Up/Legendary Notification</a>
          </li>
        
          <li>
            <a href="/2014/11/11/Time-lapse-Star-Rotation-Effect-Using-CSS-Animation/">Time-lapse Star Rotation Effect Using CSS Animation</a>
          </li>
        
          <li>
            <a href="/2014/11/08/Hexo-Code-Block-Bugs-Comments-Style-and-Empty-Lines/">Hexo Code Block Bugs: Comments Style and Empty Lines</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/AWS/" style="font-size: 10px;">AWS</a> <a href="/tags/Amazon/" style="font-size: 10px;">Amazon</a> <a href="/tags/Animation/" style="font-size: 10px;">Animation</a> <a href="/tags/Autobot/" style="font-size: 10px;">Autobot</a> <a href="/tags/Automation/" style="font-size: 10px;">Automation</a> <a href="/tags/Big-Data/" style="font-size: 20px;">Big Data</a> <a href="/tags/Blog/" style="font-size: 10px;">Blog</a> <a href="/tags/Bootstrap/" style="font-size: 10px;">Bootstrap</a> <a href="/tags/Bot/" style="font-size: 10px;">Bot</a> <a href="/tags/Bubble/" style="font-size: 10px;">Bubble</a> <a href="/tags/Bug/" style="font-size: 10px;">Bug</a> <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/Carousel/" style="font-size: 10px;">Carousel</a> <a href="/tags/CentOS/" style="font-size: 10px;">CentOS</a> <a href="/tags/Chart/" style="font-size: 10px;">Chart</a> <a href="/tags/Circle/" style="font-size: 10px;">Circle</a> <a href="/tags/Code-Block/" style="font-size: 10px;">Code Block</a> <a href="/tags/Diablo-3/" style="font-size: 10px;">Diablo 3</a> <a href="/tags/EC2/" style="font-size: 10px;">EC2</a> <a href="/tags/Flume/" style="font-size: 17.5px;">Flume</a> <a href="/tags/Google-Maps/" style="font-size: 10px;">Google Maps</a> <a href="/tags/Hadoop/" style="font-size: 10px;">Hadoop</a> <a href="/tags/Heatmap/" style="font-size: 10px;">Heatmap</a> <a href="/tags/Hexo/" style="font-size: 12.5px;">Hexo</a> <a href="/tags/Hive/" style="font-size: 10px;">Hive</a> <a href="/tags/Installation/" style="font-size: 10px;">Installation</a> <a href="/tags/Java/" style="font-size: 10px;">Java</a> <a href="/tags/Javascript/" style="font-size: 15px;">Javascript</a> <a href="/tags/LaTeX/" style="font-size: 10px;">LaTeX</a> <a href="/tags/LinkedIn/" style="font-size: 10px;">LinkedIn</a> <a href="/tags/MapR/" style="font-size: 10px;">MapR</a> <a href="/tags/Node-js/" style="font-size: 10px;">Node.js</a> <a href="/tags/Real-time/" style="font-size: 10px;">Real-time</a> <a href="/tags/Resume/" style="font-size: 10px;">Resume</a> <a href="/tags/Route/" style="font-size: 10px;">Route</a> <a href="/tags/Socket-io/" style="font-size: 10px;">Socket.io</a> <a href="/tags/Spark/" style="font-size: 12.5px;">Spark</a> <a href="/tags/Spark-Streaming/" style="font-size: 12.5px;">Spark Streaming</a> <a href="/tags/Star-Rotation/" style="font-size: 10px;">Star Rotation</a> <a href="/tags/Tableau/" style="font-size: 10px;">Tableau</a> <a href="/tags/Theme/" style="font-size: 10px;">Theme</a> <a href="/tags/Time-lapse/" style="font-size: 10px;">Time-lapse</a> <a href="/tags/Troubleshooting/" style="font-size: 10px;">Troubleshooting</a> <a href="/tags/Web/" style="font-size: 15px;">Web</a> <a href="/tags/doT/" style="font-size: 10px;">doT</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
</aside>
          
        
      </div>
      <div id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a></br>
      &copy; 2017 Xing Wu<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</div>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    
<script>
  var disqus_shortname = 'xingwu';
  
  var disqus_url = 'http://xingwu.me/2014/10/15/Spark-Streaming-Troubleshooting/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

    <a href='#logo' id='btn-btt'>^</a>
  </div>
</body>
</html>